/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'com.alibaba.datax.java-conventions'
    id 'base'
}

dependencies {
    implementation project(':datax-common')
    implementation project(':datax-core')
    implementation project(':plugin-rdbms-util')
    implementation 'com.alibaba:druid:1.1.17'
    implementation 'org.slf4j:slf4j-api:1.7.10'
    implementation 'org.apache.commons:commons-exec:1.3'
    implementation 'ch.qos.logback:logback-classic:1.0.13'
    implementation 'commons-configuration:commons-configuration:1.10'
    implementation 'com.alibaba.cloud.analyticdb:adb4pgclient:1.0.0'
}
tasks.register('copyNeed', Zip) {
    destinationDirectory = layout.buildDirectory.dir('dist')

    var pathPrefix
    if(project.getName().toString().endsWith('writer')){
        pathPrefix = 'plugin/writer/' + project.getName()
    }else if(
            project.getName().toString().endsWith('reader')
    ){
        pathPrefix = 'plugin/reader/' + project.getName()
    }

    from("$buildDir/libs"){
        into pathPrefix
    }
    from(layout.projectDirectory.dir('src/main/resources')) {
        into pathPrefix

    }

    from(configurations.runtimeClasspath)
    {
        into pathPrefix + "/libs"
    }


}

jar {

    dependsOn(copyNeed)

}

description = 'adbpgwriter'
